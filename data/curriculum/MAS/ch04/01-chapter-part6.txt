in the cross product of the two graphs. Alternating 1 2 1 2 ∈ × between the two graphs, each iteration changes one of the two points to a new pointthatisconnectedbyanedgetotheoriginalpoint. Startingfrom(0,0),which is completelylabeled,the algorithmpicksoneofthe two graphsandmovesfrom 0 in that graph to some adjacent node x. The node x, together with the 0 from the othergraph, togetherform analmostcompletelylabeledpair, in that between them they miss exactly one label. The algorithm then movesfrom the remaining 0 to a neighboring node that picks up that missing label, but in the process loses a different label. The process thus proceeds, alternating between the two graphs, untilanequilibrium(i.e.,atotallylabeledpair)isreached. Inourrunningexample,apossibleexecutionofthealgorithmstartsat(0,0)and then changes s to (0,1,0). Now, our pair (0,1,0),(0,0) is a1-almost com1 2 pletelylabeled,andtheduplicatelabelisa2. ForitsnextstepinG thealgorithm 2 (cid:0) (cid:1) 2 moves to (0,1) because the other possible choice, (1,0), has the label a2. Re2 turning to G for the next iteration, we move to 2,1,0 because it is the point 1 3 3 adjacent to (0,1,0) that does not have the duplicate label a1. The final step is to change s to 1,2 in order to move away fr (cid:0) om the (cid:1) labe 1 l a1. We have now 2 3 3 2 reachedthe completely labeled pair 2,1,0 , 1,2 , and the algorithm termi- (cid:0) (cid:1) 3 3 3 3 nates. This execution trace can be summarized by the path ((0,0,0),(0,0)) ((0,1,0),(0,0)) ((0,1,0),(0,1) (cid:0) ) (cid:0) ((2(cid:1) ,1, (cid:0) 0),( (cid:1) 0 (cid:1) ,1)) ((2, 1,0),(1,2 → )). → → 3 3 → 3 3 3 3 TheLemke–Howsonalgorithm: Adeeperlookatpivoting ThegraphicaldescriptionoftheLemke–Howsonalgorithmintheprevioussection provides good intuition but glosses over elements that only a close look at the algebraic formulation reveals. Specifically, in abstracting away to the graphical exposition we did not specify how to compute the graph nodes from the game description. This is the role of this section. The two sections complement each other: Thisoneprovidesaclearrecipeforimplementingthealgorithm,butonits ownwouldprovidelittleintuition. Theprevioussectiondidtheopposite. Infact,wedonotcomputethenodesinadvanceatall. Instead,wecomputethem incrementally along the path being explored. At each step, we find the missing label to be added (called the entering variable), add it, find out which label has beenlost(itiscalledtheleavingvariable),andtheprocessrepeatsuntilnovariable pivotalgorithms islostinwhichcaseasolutionhasbeenobtained.Thisprocedureiscalledpivoting, andalsounderliesthesimplexalgorithmforsolvinglinearprogrammingproblems. simplex Thehigh-leveldescriptionoftheLemke–HowsonalgorithmisgiveninFigure4.5. algorithm As can be seen from the pseudocode, identifying the entering variable follows UncorrectedmanuscriptofMultiagentSystems,publishedbyCambridgeUniversityPress Revision1.1©Shoham&Leyton-Brown,2009,2010. 4.2 ComputingNashequilibriaoftwo-player,general-sumgames 99 initializethetwosystemsofequationsattheorigin arbitrarilypickonedependentvariablefromoneofthetwosystems. This variableentersthebasis. repeat identifyoneofthepreviousbasisvariableswhichmustleave,according totheminimumratiotest. Theresultisanewbasis. ifthisbasisiscompletelylabeledthen returnthebasis //wehavefoundanequilibrium. else thevariabledualtothevariablethatlastleftentersthebasis. Figure4.5: PseudocodefortheLemke–Howsonalgorithm. immediatelyfromthecurrentlabeling(exceptinthefirststep,inwhichthechoice is arbitrary). The only nontrivial step is identifying the leaving variable. We explainitbytracingtheoperationofthealgorithmonourexample. Westartwithareformulationofthefirsttwoconstraints(4.14)and(4.15)from ourLCPformulation.7 r = 1 6y′ 1 − 5 r = 1 2y′ 5y′ (4.20) 2 − 4 − 5 r = 1 3y′ 3y′ 3 − 4 − 5 s = 1 x′ 4x′ 4 − 1 − 3 (4.21) s = 1 2x′ 3x′ 5 − 2 − 3 This system admits the trivialsolution ofassigning0to allvariableson the righthandside,whichisourfictitiousstartingpoint. Atthispoint,r ,r ,r ,s ,s form 1 2 3 4 5 the basis of oursystem of equations, and the othervariables (the y′s and the x′s) are the dependentvariables.8 Note that each basis variable has a dual dependent one;the dualpairsare (r ,x′), (r ,x′), (r ,x′), (s ,y′),