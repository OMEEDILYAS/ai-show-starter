is therefore lowerboundedbybest_util(itisbest_utilifhhasnochildrenwithlargervalues, and is some larger amountotherwise). Either way, if best_util β then player ≥ 1knowsthatplayer2preferschoosinghisbestalternative(atsomeancestornode of h) rather than allowing player 1 to act at node h. Thus node h cannot be on UncorrectedmanuscriptofMultiagentSystems,publishedbyCambridgeUniversityPress Revision1.1©Shoham&Leyton-Brown,2009,2010. 5.1 Perfect-informationextensive-formgames 127 1 α=8 • β=∞ 2 α=−∞ 2 α=8 • β=8 • β=∞ • • • ··· ··· (10) (8) (6) Figure5.8: Anexampleofalpha-betapruning. Wecanbacktrackafterexpanding thefirstchildoftherightchoicenodeforplayer2. theequilibriumpath2 andso thereis noneedto continueexploringthe gametree belowh. AsimpleexampleofALPHABETAPRUNINGinactionisgiveninFigure5.8. The search begins by heading down the left branch and visiting both terminal nodes, and eventually setting β = 8. (Do you see why?) It then returns the value 8 as the value of this subgame, which causes α to be set to 8 at the root node. In the rightsubgamethesearchvisitsthefirstterminalnodeandsosetsbest_util = 6at theshadednode,whichwewillcallh. Nowathwehavebest_util α, which ≤ meansthat we canbacktrack. This is safe to dobecausewe have justshownthat player1 would neverchoose this subgame: he can guaranteehimself a payoffof 8bychoosingtheleftsubgame,whereashisutilityintherightsubgamewouldbe nomorethan6. The effectiveness of the alpha-beta pruning algorithm depends on the order in which nodes are considered. For example, if player1 considersnodes in increasingorderoftheirvalue,andplayer2considersnodesindecreasingorderofvalue, then no nodes will ever be pruned. In the best case (where nodes are ordered in decreasingvalueforplayer1andinincreasingorderforplayer2),alpha-betapruninghascomplexityofO(bm 2 ). WecanrewritethisexpressionasO(√b m ),making moreexplicitthefactthatthegame’sbranchingfactorwouldeffectivelybecutto thesquarerootofitsoriginalvalue.Ifnodesareexaminedinrandomorderthenthe analysisbecomessomewhatmorecomplicated;whenbisfairlysmall,thecomplexityofalpha-betapruningisO(b3 4 m),whichisstillanexponentialimprovement.In practice,itisusuallypossibletoachieveperformancesomewherebetweenthebest caseand the randomcase. This techniquethus offers substantialpracticalbenefit overstraightforwardbackwardinductionintwo-player,zero-sumgamesforwhich thegametreeisrepresentedimplicitly. 2. Infact,inthecasebest_util=β,itispossiblethathcouldbereachedonanequilibriumpath;however, inthis case there is still always anequilibrium inwhich player 2plays hisbest alternative andhis not reached. Freeforon-screenuse;pleasedonotdistribute.Youcangetanotherfreecopy ofthisPDFororderthebookathttp://www.masfoundations.org. 128 5 GameswithSequentialActions:ReasoningandComputingwiththeExtensiveForm Techniqueslikealpha-betapruningarecommonlyusedtobuildstrongcomputer playersfortwo-playerboardgamessuchaschess. (However,theyperformpoorly ongameswithextremelylargebranchingfactors,suchasgo.) Ofcourse,building agoodcomputerplayerinvolvesagreatdealofengineering,andrequiresconsiderableattentiontogame-specificheuristicssuchasthoseusedtoorderactions. One generaltechniqueisrequiredbymanysuchsystems,however,andsoisworthdiscussinghere. Thegametreeinpracticalgamescanbesolargethatitisinfeasible tosearchallthewaydowntoleafnodes. Instead,thesearchproceedstosomeshallower depth (which is chosen either statically or dynamically). Where do we get thenodevaluestopropagateupusingbackwardinduction? Thetrick is tousean evaluation evaluationfunctiontoestimatethe valueofthe deepestnodereached(takinginto function accountgame-relevantfeaturessuchasboardposition,numberofpiecesforeach player, who gets to move next, etc., and either built by hand or learned). When thesearchhasreachedanappropriatedepth,thenodeistreatedasterminalwitha calltotheevaluationfunctionreplacingtheevaluationoftheutilityfunctionatthat node. This requires a small change to the beginning of ALPHABETAPRUNING; otherwise,thealgorithmworksunchanged. Two-player,general-sumgames:computingallsubgame-perfectequilibria WhiletheBACKWARDINDUCTION procedureidentifiesonesubgame-perfectequilibrium in linear time, it does not provide an efficient way of finding all of them. One might wonder how there could even be more than one SPE in a perfectinformation game. Multiple subgame-perfect equilibria can exist when there exist one or more decision nodes at which a player chooses between subgames in whichhereceivesthesameutility. Insuchcases BACKWARDINDUCTION simply chooses the first subgame it encountered. It could be useful to find the set of all subgame-perfectequilibriaifwewantedtofindaspecificSPE(aswedidwithNash equilibriaofnormal-formgamesinSection4.2.4)suchastheonethatmaximizes socialwelfare. Here let us restrict ourselves to two-player perfect-information extensive-form games, but lift our previous restriction that the game be zero-sum. A somewhat more complicated algorithm can find the set of all subgame-perfect equilibrium valuesinworst-casecubictime. Theorem5.1.6 Givenatwo-playerperfect-informationextensive-formgamewith ℓleaves,thesetofsubgame-perfectequilibriumpayoffscanberepresentedasthe unionofO(ℓ2)axis-alignedrectanglesandcanbecomputedintimeO(ℓ3). Intuitively,thealgorithmworksmuchlikeBACKWARDINDUCTION, butthevariableutil_at_childholdsarepresentationofallequilibriumvaluesinsteadofjust one. The “max” operation we had previously implemented through best_util is replacedbya subroutinethatreturnsa representationofallthe valuesthatcanbe obtained in subgame-perfect equilibria of the node’s children. This can include UncorrectedmanuscriptofMultiagentSystems,publishedbyCambridgeUniversityPress Revision1.1©Shoham&Leyton-Brown,2009,2010. 5.1 Perfect-informationextensive-formgames 129 mixed strategies if multiple children are simultaneously best responses. More information about this algorithm can be found in the reference cited in the chapter notes. Anexampleandcriticismsofbackwardinduction Despite the fact that strong arguments can be made in its favor, the concept of backward induction is not without controversy. To see why this is, consider the Centipedegame