value zero on all off-diagonal ele- diagonalmatrix ments,i.e.,theyareoftheform   c 0 1 ··· D =   . . . ... . . .   . (4.49) 0 c n ··· They allow fast computation of determinants, powers, and inverses. The determinant is the product of its diagonal entries, a matrix power Dk is given by each diagonal element raised to the power k, and the inverse D−1 isthereciprocalofitsdiagonalelementsifallofthemarenonzero. Inthissection,wewilldiscusshowtotransformmatricesintodiagonal (cid:13)c2019M.P.Deisenroth,A.A.Faisal,C.S.Ong.TobepublishedbyCambridgeUniversityPress. 116 MatrixDecompositions form.Thisisanimportantapplicationofthebasischangewediscussedin Section2.7.2andeigenvaluesfromSection4.2. Recall that two matrices A,D are similar (Definition 2.22) if there existsaninvertiblematrixP,suchthatD = P−1AP.Morespecifically,we will look at matrices A that are similar to diagonal matrices D that containtheeigenvaluesofAonthediagonal. diagonalizable Definition 4.19 (Diagonalizable). A matrix A Rn×n is diagonalizable ∈ ifitissimilartoadiagonalmatrix,i.e.,ifthereexistsaninvertiblematrix P Rn×n suchthatD = P−1AP. ∈ In the following, we will see that diagonalizing a matrix A Rn×n is ∈ a way of expressing the same linear mapping but in another basis (see Section2.6.1),whichwillturnouttobeabasisthatconsistsoftheeigenvectorsofA. LetA Rn×n,letλ ,...,λ beasetofscalars,andletp ,...,p bea set of vec ∈ tors in Rn. W 1 e define n P := [p ,...,p ] and let D 1 Rn×n n be a 1 n ∈ diagonalmatrixwithdiagonalentriesλ ,...,λ .Thenwecanshowthat 1 n AP = PD (4.50) if and only if λ ,...,λ are the eigenvalues of A and p ,...,p are cor1 n 1 n respondingeigenvectorsofA. Wecanseethatthisstatementholdsbecause AP = A[p ,...,p ] = [Ap ,...,Ap ], (4.51) 1 n 1 n   λ 0 1 PD = [p 1 ,...,p n ]  ...   = [λ 1 p 1 ,...,λ n p n ]. (4.52) 0 λ n Thus,(4.50)impliesthat Ap = λ p (4.53) 1 1 1 . . . Ap = λ p . (4.54) n n n Therefore,thecolumnsofP mustbeeigenvectorsofA. Our definition of diagonalization requires that P Rn×n is invertible, ∈ i.e., P has full rank (Theorem 4.3). This requires us to have n linearly independenteigenvectorsp ,...,p ,i.e.,thep formabasisofRn. 1 n i Theorem 4.20 (Eigendecomposition). A square matrix A Rn×n can be ∈ factoredinto A = PDP−1, (4.55) where P Rn×n and D is a diagonal matrix whose diagonal entries are theeigenva ∈ luesofA,ifandonlyiftheeigenvectorsofAformabasisofRn. Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 4.4 EigendecompositionandDiagonalization 117 Figure4.7 Intuition behindthe p 2 eigendecomposition λ p λ p p 1 2 2 1 1 assequential A transformations. Top-leftto bottom-left:P−1 performsabasis P−1 P change(heredrawn inR2anddepicted e 2 asarotation-like λ e operation),mapping 2 2 D theeigenvectors e 1 λ e intothestandard 1 1 basis.Bottom-leftto bottom-right:D performsascaling alongtheremapped Theorem4.20impliesthatonlynon-defectivematricescanbediagonal- orthogonal izedandthatthecolumnsofP aretheneigenvectorsofA.Forsymmetric eigenvectors, depictedherebya matriceswecanobtainevenstrongeroutcomesfortheeigenvaluedecomcirclebeing position. stretchedtoan ellipse.Bottom-right Theorem4.21. AsymmetricmatrixS Rn×n canalwaysbediagonalized. totop-right:P ∈ undoesthebasis Theorem 4.21 follows directly from the spectral theorem 4.15. More- change(depictedas over,thespectraltheoremstatesthatwecanfindanONBofeigenvectors areverserotation) ofRn.ThismakesP anorthogonalmatrixsothatD = P(cid:62)AP. andrestoresthe originalcoordinate Remark. TheJordannormalformofamatrixoffersadecompositionthat frame. works for defective matrices (Lang, 1987) but is beyond the scope of this book. ♦ Geometric Intuition for the Eigendecomposition We can interpret the eigendecomposition of a matrix as follows (see also Figure4.7):LetAbethetransformationmatrixofalinearmappingwith respecttothestandardbasis.P−1 performsabasischangefromthestandardbasisintotheeigenbasis.Thisidentifiestheeigenvectorsp (redand i orangearrowsinFigure4.7)ontothestandardbasisvectorse .Then,the i diagonal D scales the vectors along these axes by the eigenvalues λ . Fii nally,P transformsthesescaledvectorsbackintothestandard/canonical coordinatesyieldingλ p . i i Example 4.11 (Eigendecomposition)