The distribution function technique in Section 6.7.1 is derived from first principles, based on the definitions of cdfs and using properties of inverses,differentiation,andintegration.Thisargumentfromfirstprinciples reliesontwofacts: 1. WecantransformthecdfofY intoanexpressionthatisacdfofX. 2. Wecandifferentiatethecdftoobtainthepdf. Letusbreakdownthereasoningstepbystep,withthegoalofunderstandingthemoregeneralchange-of-variablesapproachinTheorem6.16. Changeofvariables inprobabilityrelies Remark. The name “change of variables” comes from the idea of changonthe ing the variable of integration when faced with a difficult integral. For change-of-variables univariatefunctions,weusethesubstitutionruleofintegration, methodin calculus(Tandra, (cid:90) (cid:90) f(g(x))g(cid:48)(x)dx = f(u)du, where u = g(x). (6.133) 2014). Thederivationofthisruleisbasedonthechainruleofcalculus(5.32)and byapplyingtwicethefundamentaltheoremofcalculus.Thefundamental theoremofcalculusformalizesthefactthatintegrationanddifferentiation are somehow “inverses” of each other. An intuitive understanding of the rule can be obtained by thinking (loosely) about small changes (differentials)totheequationu = g(x),thatisbyconsidering∆u = g(cid:48)(x)∆xasa differentialofu = g(x).Bysubsitutingu = g(x),theargumentinsidethe integralontheright-handsideof(6.133)becomesf(g(x)).Bypretending that the term du can be approximated by du ∆u = g(cid:48)(x)∆x, and that ≈ dx ∆x,weobtain(6.133). ≈ ♦ Consider a univariate random variable X, and an invertible function U, which gives us another random variable Y = U(X). We assume that random variable X has states x [a,b]. By the definition of the cdf, we ∈ have F (y) = P(Y (cid:54) y). (6.134) Y (cid:13)c2019M.P.Deisenroth,A.A.Faisal,C.S.Ong.TobepublishedbyCambridgeUniversityPress. 218 ProbabilityandDistributions WeareinterestedinafunctionU oftherandomvariable P(Y (cid:54) y) = P(U(X) (cid:54) y), (6.135) where we assume that the function U is invertible. An invertible function onanintervaliseitherstrictlyincreasingorstrictlydecreasing.Inthecase thatU isstrictlyincreasing,thenitsinverseU−1 isalsostrictlyincreasing. ByapplyingtheinverseU−1 totheargumentsofP(U(X) (cid:54) y),weobtain P(U(X) (cid:54) y) = P(U−1(U(X)) (cid:54) U−1(y)) = P(X (cid:54) U−1(y)). (6.136) Theright-mosttermin(6.136)isanexpressionofthecdfofX.Recallthe definitionofthecdfintermsofthepdf (cid:90) U−1(y) P(X (cid:54) U−1(y)) = f(x)dx. (6.137) a NowwehaveanexpressionofthecdfofY intermsofx: (cid:90) U−1(y) F (y) = f(x)dx. (6.138) Y a Toobtainthepdf,wedifferentiate(6.138)withrespecttoy: d d (cid:90) U−1(y) f(y) = F (y) = f(x)dx. (6.139) dy y dy a Note that the integral on the right-hand side is with respect to x, but we need an integral with respect to y because we are differentiating with respecttoy.Inparticular,weuse(6.133)togetthesubstitution (cid:90) (cid:90) f(U−1(y))U−1(cid:48) (y)dy = f(x)dx where x = U−1(y). (6.140) Using(6.140)ontheright-handsideof(6.139)givesus d (cid:90) U−1(y) f(y) = f (U−1(y))U−1(cid:48) (y)dy. (6.141) dy x a We then recall that differentiation is a linear operator and we use the subscriptxtoremindourselvesthatf (U−1(y))isafunctionofxandnot x y.Invokingthefundamentaltheoremofcalculusagaingivesus (cid:18) (cid:19) d f(y) = f (U−1(y)) U−1(y) . (6.142) x · dy RecallthatweassumedthatU isastrictlyincreasingfunction.Fordecreasing functions, it turns out that we have a negative sign when we follow thesamederivation.Weintroducetheabsolutevalueofthedifferentialto havethesameexpressionforbothincreasinganddecreasingU: (cid:12) (cid:12) (cid:12) d (cid:12) f(y) = f x (U−1(y)) · (cid:12) (cid:12)dy U−1(y)(cid:12) (cid:12) . (6.143) Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 6.7 ChangeofVariables/InverseTransform 219 (cid:12) (cid:12) This is called the change-of-variable technique. The term (cid:12) (cid:12)d d y U−1(y)(cid:12) (cid:12) in change-of-variable (6.143) measures how much a unit volume changes when applying U technique (seealsothedefinitionoftheJacobianinSection5.3). Remark. Incomparisontothediscretecasein(6.125b),wehaveanaddi- (cid:12) (cid:12) tionalfactor(cid:12) d U−1(y)(cid:12).Thecontinuouscaserequiresmorecarebecause (cid:12)dy (cid:12) P(Y = y) = 0 for all y. The probability density function f(y) does not haveadescriptionasaprobabilityofaneventinvolvingy. ♦ Sofarinthissection,wehavebeenstudyingunivariatechangeofvariables. The case for multivariate random variables is analogous, but complicated by fact that the absolute value cannot be used for multivariate functions. Instead, we use the determinant of the Jacobian matrix. Recall from (5.58) that the Jacobian is a matrix of partial derivatives, and that the existence of a nonzero determinant shows that we can invert the Jacobian. Recall the discussion in Section 4.1 that the determinant