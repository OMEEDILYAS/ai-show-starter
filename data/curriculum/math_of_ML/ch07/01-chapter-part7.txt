(7.29) − ∈ C Figure7.5 Example ofaconvexset. Convex sets are sets such that a straight line connecting any two elements of the set lie inside the set. Figures 7.5 and 7.6 illustrate convex andnonconvexsets,respectively. Convex functions are functions such that a straight line between any twopointsofthefunctionlieabovethefunction.Figure7.2showsanonconvexfunction,andFigure7.3showsaconvexfunction.Anotherconvex functionisshowninFigure7.7. Figure7.6 Example ofanonconvexset. Definition7.3. Letfunctionf : RD Rbeafunctionwhosedomainisa → convexset.Thefunctionf isaconvexfunctionifforallx,y inthedomain off,andforanyscalarθ with0 (cid:54) θ (cid:54) 1,wehave f(θx+(1 θ)y) (cid:54) θf(x)+(1 θ)f(y). (7.30) − − Remark. Aconcavefunctionisthenegativeofaconvexfunction. ♦ Theconstraintsinvolvingg( )andh( )in(7.28)truncatefunctionsata convexfunction · · scalar value, resulting in sets. Another relation between convex functions concavefunction and convex sets is to consider the set obtained by “filling in” a convex function.Aconvexfunctionisabowl-likeobject,andweimaginepouring epigraph water into it to fill it up. This resulting filled-in set, called the epigraph of theconvexfunction,isaconvexset. If a function f : Rn R is differentiable, we can specify convexity in → Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 7.3 ConvexOptimization 237 Figure7.7 Example ofaconvex 40 function. 30 20 10 0 3 2 1 0 1 2 3 − − − x y y=3x2 5x+2 − terms of its gradient f(x) (Section 5.2). A function f(x) is convex if x ∇ andonlyifforanytwopointsx,y itholdsthat f(y) (cid:62) f(x)+ f(x)(cid:62)(y x). (7.31) x ∇ − Ifwefurtherknowthatafunctionf(x)istwicedifferentiable,thatis,the Hessian(5.147)existsforallvaluesinthedomainofx,thenthefunction f(x) is convex if and only if 2f(x) is positive semidefinite (Boyd and ∇x Vandenberghe,2004). Example 7.3 The negative entropy f(x) = xlog x is convex for x > 0. A visualization 2 ofthefunctionisshowninFigure7.8,andwecanseethatthefunctionis convex.Toillustratethepreviousdefinitionsofconvexity,letuscheckthe calculationsfortwopointsx = 2andx = 4.Notethattoproveconvexity off(x)wewouldneedtocheckforallpointsx R. ∈ RecallDefinition7.3.Considerapointmidwaybetweenthetwopoints (thatisθ = 0.5);thentheleft-handsideisf(0.5 2+0.5 4) = 3log 3 · · 2 ≈ 4.75.Theright-handsideis0.5(2log 2)+0.5(4log 4) = 1+4 = 5.And 2 2 thereforethedefinitionissatisfied. Sincef(x)isdifferentiable,wecanalternativelyuse(7.31).Calculating thederivativeoff(x),weobtain 1 1 (xlog x) = 1 log x+x = log x+ . (7.32) ∇ x 2 · 2 · xlog 2 2 log 2 e e Using the same two test points x = 2 and x = 4, the left-hand side of (7.31)isgivenbyf(4) = 8.Theright-handsideis f(x)+ (cid:62)(y x) = f(2)+ f(2) (4 2) (7.33a) ∇x − ∇ · − 1 = 2+(1+ ) 2 6.9. (7.33b) log 2 · ≈ e (cid:13)c2019M.P.Deisenroth,A.A.Faisal,C.S.Ong.TobepublishedbyCambridgeUniversityPress. 238 ContinuousOptimization Figure7.8 The negativeentropy function(whichis 10 convex)andits tangentatx=2. 5 0 0 1 2 3 4 5 x )x(f xlog x 2 tangent at x=2 We can check that a function or set is convex from first principles by recallingthedefinitions.Inpractice,weoftenrelyonoperationsthatpreserve convexity to check that a particular function or set is convex. Although the details are vastly different, this is again the idea of closure thatweintroducedinChapter2forvectorspaces. Example 7.4 A nonnegative weighted sum of convex functions is convex. Observe that if f is a convex function, and α (cid:62) 0 is a nonnegative scalar, then the functionαf isconvex.Wecanseethisbymultiplyingαtobothsidesofthe equation in Definition 7.3, and recalling that multiplying a nonnegative numberdoesnotchangetheinequality. Iff andf areconvexfunctions,thenwehavebythedefinition 1 2 f (θx+(1 θ)y) (cid:54) θf (x)+(1 θ)f (y) (7.34) 1 1 1 − − f (θx+(1 θ)y) (cid:54) θf (x)+(1 θ)f (y). (7.35) 2 2 2 − − Summingupbothsidesgivesus f (θx+(1 θ)y)+f (θx+(1 θ)y) 1 2 − − (cid:54) θf (x)+(1 θ)f (y)+θf (x)+(1 θ)f (y), (7.36) 1 1 2 2