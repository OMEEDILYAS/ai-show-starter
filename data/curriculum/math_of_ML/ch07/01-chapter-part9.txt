x 2 1 0 1 1 − of two variables. The program is also illustrated in Figure 7.4. The objective function is quadratic with a positive semidefinite matrix Q, resulting inellipticalcontourlines.Theoptimalvaluemustlieintheshaded(feasible)region,andisindicatedbythestar. TheLagrangianisgivenby 1 L(x,λ) = x(cid:62)Qx+c(cid:62)x+λ(cid:62)(Ax b) (7.48a) 2 − 1 = x(cid:62)Qx+(c+A(cid:62)λ)(cid:62)x λ(cid:62)b, (7.48b) 2 − whereagainwehaverearrangedtheterms.TakingthederivativeofL(x,λ) withrespecttoxandsettingittozerogives Qx+(c+A(cid:62)λ) = 0. (7.49) AssumingthatQisinvertible,weget x = Q−1(c+A(cid:62)λ). (7.50) − Substituting (7.50) into the primal Lagrangian L(x,λ), we get the dual Lagrangian 1 D(λ) = (c+A(cid:62)λ)(cid:62)Q−1(c+A(cid:62)λ) λ(cid:62)b. (7.51) −2 − (cid:13)c2019M.P.Deisenroth,A.A.Faisal,C.S.Ong.TobepublishedbyCambridgeUniversityPress. 242 ContinuousOptimization Therefore,thedualoptimizationproblemisgivenby 1 max (c+A(cid:62)λ)(cid:62)Q−1(c+A(cid:62)λ) λ(cid:62)b λ∈Rm − 2 − (7.52) subjectto λ (cid:62) 0. Wewillseeanapplicationofquadraticprogramminginmachinelearning inChapter12. 7.3.3 Legendre–Fenchel Transform and Convex Conjugate Let us revisit the idea of duality from Section 7.2, without considering constraints. One useful fact about a convex set is that it can be equivalently described by its supporting hyperplanes. A hyperplane is called a supporting supporting hyperplane of a convex set if it intersects the convex set, and hyperplane theconvexsetiscontainedonjustonesideofit.Recallthatwecanfillup aconvexfunctiontoobtaintheepigraph,whichisaconvexset.Therefore, wecanalsodescribeconvexfunctionsintermsoftheirsupportinghyperplanes.Furthermore,observethatthesupportinghyperplanejusttouches the convex function, and is in fact the tangent to the function at that point. And recall that the tangent of a function f(x) at a given point x 0 (cid:12) is the evaluation of the gradient of that function at that point df(x)(cid:12) . dx (cid:12) x=x0 Insummary,becauseconvexsetscanbeequivalentlydescribedbyitssupporting hyperplanes, convex functions can be equivalently described by a Legendretransform functionoftheirgradient.TheLegendretransformformalizesthisconcept Physicsstudentsare . oftenintroducedto We begin with the most general definition, which unfortunately has a theLegendre counter-intuitiveform,andlookatspecialcasestorelatethedefinitionto transformas the intuition described in the preceding paragraph. The Legendre–Fenchel relatingthe Lagrangianandthe transform is a transformation (in the sense of a Fourier transform) from Hamiltonianin a convex differentiable function f(x) to a function that depends on the classicalmechanics. tangentss(x) = f(x).Itisworthstressingthatthisisatransformation x Legendre–Fenchel ∇ ofthefunctionf( )andnotthevariablexorthefunctionevaluatedatx. transform · The Legendre–Fenchel transform is also known as the convex conjugate convexconjugate (for reasons we will see soon) and is closely related to duality (HiriartUrrutyandLemar´echal,2001,chapter5). convexconjugate Definition 7.4. The convex conjugate of a function f : RD R is a → functionf∗ definedby f∗(s) = sup ( s,x f(x)) . (7.53) x∈RD (cid:104) (cid:105)− Note that the preceding convex conjugate definition does not need the functionf tobeconvexnordifferentiable.InDefinition7.4,wehaveused a general inner product (Section 3.2) but in the rest of this section we Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 7.3 ConvexOptimization 243 willconsiderthestandarddotproductbetweenfinite-dimensionalvectors ( s,x = s(cid:62)x)toavoidtoomanytechnicaldetails. (cid:104) (cid:105) To understand Definition 7.4 in a geometric fashion, consider an nice Thisderivationis simple one-dimensional convex and differentiable function, for example easiestto f(x) = x2.Note thatsince weare lookingat aone-dimensional problem, understandby drawingthe hyperplanesreducetoaline.Consideraliney = sx+c.Recallthatweare reasoningasit able to describe convex functions by their supporting hyperplanes, so let progresses. us try to describe this function f(x) by its supporting lines. Fix the gradientofthelines Randforeachpoint(x ,f(x ))onthegraphoff,find 0 0 ∈ theminimumvalueofcsuchthatthelinestillintersects(x ,f(x )).Note 0 0 that the minimum value of c is the place where a line with slope s “just touches” the function f(x) = x2. The line passing through (x ,f(x )) 0 0 withgradientsisgivenby y f(x ) = s(x x ). (7.54) 0 0 − − The y-intercept of this line is sx +f(x ). The minimum