different approaches to duality: In this section, we discuss Lagrangianduality;inSection7.3.3,wediscussLegendre–Fenchelduality. Definition 7.1. Theproblemin(7.17) min f(x) (7.21) x subjectto g (x) (cid:54) 0 forall i = 1,...,m i primalproblem is known as the primal problem, corresponding to the primal variables x. Lagrangiandual TheassociatedLagrangiandualproblemisgivenby problem max D(λ) λ∈Rm (7.22) subjectto λ (cid:62) 0, whereλarethedualvariablesandD(λ) = min x∈Rd L(x,λ). Remark. InthediscussionofDefinition7.1,weusetwoconceptsthatare alsoofindependentinterest(BoydandVandenberghe,2004). minimaxinequality First is the minimax inequality, which says that for any function with twoargumentsϕ(x,y),themaximinislessthantheminimax,i.e., maxminϕ(x,y) (cid:54) minmaxϕ(x,y). (7.23) y x x y Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 7.2 ConstrainedOptimizationandLagrangeMultipliers 235 Thisinequalitycanbeprovedbyconsideringtheinequality Forallx,y minϕ(x,y) (cid:54) maxϕ(x,y). (7.24) x y Notethattakingthemaximumoveryoftheleft-handsideof(7.24)maintains the inequality since the inequality is true for all y. Similarly, we can taketheminimumoverxoftheright-handsideof(7.24)toobtain(7.23). The second concept is weak duality, which uses (7.23) to show that weakduality primal values are always greater than or equal to dual values. This is describedinmoredetailin(7.27). ♦ Recall that the difference between J(x) in (7.18) and the Lagrangian in (7.20b) is that we have relaxed the indicator function to a linear function. Therefore, when λ (cid:62) 0, the Lagrangian L(x,λ) is a lower bound of J(x).Hence,themaximumofL(x,λ)withrespecttoλis J(x) = maxL(x,λ). (7.25) λ(cid:62)0 RecallthattheoriginalproblemwasminimizingJ(x), min maxL(x,λ). (7.26) x∈Rd λ(cid:62)0 By the minimax inequality (7.23), it follows that swapping the order of theminimumandmaximumresultsinasmallervalue,i.e., min maxL(x,λ) (cid:62) max min L(x,λ). (7.27) x∈Rd λ(cid:62)0 λ(cid:62)0 x∈Rd This is also known as weak duality. Note that the inner part of the right- weakduality handsideisthedualobjectivefunctionD(λ)andthedefinitionfollows. Incontrasttotheoriginaloptimizationproblem,whichhasconstraints, min x∈Rd L(x,λ) is an unconstrained optimization problem for a given value of λ. If solving min x∈Rd L(x,λ) is easy, then the overall problem is easy to solve. The reason is that the outer problem (maximization over λ) is a maximum over a set of affine functions, and hence is a concave function,eventhoughf( )andg ( )maybenonconvex.Themaximumof i · · aconcavefunctioncanbeefficientlycomputed. Assuming f( ) and g ( ) are differentiable, we find the Lagrange dual i · · problem by differentiating the Lagrangian with respect to x, setting the differentialtozero,andsolvingfortheoptimalvalue.Wewilldiscusstwo concrete examples in Sections 7.3.1 and 7.3.2, where f( ) and g ( ) are i · · convex. Remark (Equality Constraints). Consider (7.17) with additional equality constraints min f(x) x subjectto g (x) (cid:54) 0 forall i = 1,...,m (7.28) i h (x) = 0 forall j = 1,...,n. j (cid:13)c2019M.P.Deisenroth,A.A.Faisal,C.S.Ong.TobepublishedbyCambridgeUniversityPress. 236 ContinuousOptimization We can model equality constraints by replacing them with two inequality constraints.Thatisforeachequalityconstrainth (x) = 0weequivalently j replace it by two constraints h (x) (cid:54) 0 and h (x) (cid:62) 0. It turns out that j j theresultingLagrangemultipliersarethenunconstrained. Therefore, we constrain the Lagrange multipliers corresponding to the inequality constraints in (7.28) to be non-negative, and leave the Lagrangemultiplierscorrespondingtotheequalityconstraintsunconstrained. ♦ 7.3 Convex Optimization We focus our attention of a particularly useful class of optimization problems, where we can guarantee global optimality. When f( ) is a convex · function,andwhentheconstraintsinvolvingg( )andh( )areconvexsets, · · convexoptimization thisiscalledaconvexoptimizationproblem.Inthissetting,wehavestrong problem duality: The optimal solution of the dual problem is the same as the optistrongduality malsolutionoftheprimalproblem.Thedistinctionbetweenconvexfunctionsandconvexsetsareoftennotstrictlypresentedinmachinelearning literature,butonecanofteninfertheimpliedmeaningfromcontext. convexset Definition7.2. Aset isaconvexsetifforanyx,y andforanyscalar θ with0 (cid:54) θ (cid:54) 1,weh C ave ∈ C θx+(1 θ)y .