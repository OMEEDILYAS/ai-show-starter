j i j i j i i j j j i 2 (cid:104) (cid:105)− i=1 j=1 i=1 j=1 N N N N N (cid:88) (cid:88) (cid:88) (cid:88) (cid:88) +C ξ b y α + α α ξ γ ξ . i i i i i i i i − − − i=1 i=1 i=1 i=1 i=1 (12.39) Note that there are no longer any terms involving the primal variable w. Bysetting(12.36)tozero,weobtain (cid:80)N y α = 0.Therefore,theterm n=1 n n involving b also vanishes. Recall that inner products are symmetric and Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 12.3 DualSupportVectorMachine 385 bilinear (see Section 3.2). Therefore, the first two terms in (12.39) are over the same objects. These terms (colored blue) can be simplified, and weobtaintheLagrangian N N N N 1 (cid:88)(cid:88) (cid:88) (cid:88) D(ξ,α,γ) = y y α α x ,x + α + (C α γ )ξ . i j i j i j i i i i −2 (cid:104) (cid:105) − − i=1 j=1 i=1 i=1 (12.40) Thelastterminthisequationisacollectionofalltermsthatcontainslack variablesξ .Bysetting(12.37)tozero,weseethatthelasttermin(12.40) i is also zero. Furthermore, by using the same equation and recalling that the Lagrange multiplers γ are non-negative, we conclude that α (cid:54) C. i i We now obtain the dual optimization problem of the SVM, which is expressed exclusively in terms of the Lagrange multipliers α . Recall from i Lagrangian duality (Definition 7.1) that we maximize the dual problem. This is equivalent to minimizing the negative dual problem, such that we endupwiththedualSVM dualSVM N N N 1 (cid:88)(cid:88) (cid:88) min y y α α x ,x α i j i j i j i α 2 (cid:104) (cid:105)− i=1 j=1 i=1 N (12.41) (cid:88) subjectto y α = 0 i i i=1 0 (cid:54) α (cid:54) C forall i = 1,...,N . i The equality constraint in (12.41) is obtained from setting (12.36) to zero. The inequality constraint α (cid:62) 0 is the condition imposed on Lai grange multipliers of inequality constraints (Section 7.2). The inequality constraintα (cid:54) C isdiscussedinthepreviousparagraph. i ThesetofinequalityconstraintsintheSVMarecalled“boxconstraints” because they limit the vector α = [α , ,α ](cid:62) RN of Lagrange mul1 N ··· ∈ tipliers to be inside the box defined by 0 and C on each axis. These axis-aligned boxes are particularly efficient to implement in numerical solvers(Dosta´l,2009,chapter5). Itturnsoutthat Once we obtain the dual parameters α, we can recover the primal pa- examplesthatlie exactlyonthe rameters w by using the representer theorem (12.38). Let us call the opmarginare timal primal parameter w∗. However, there remains the question on how exampleswhose to obtain the parameter b∗. Consider an example x n that lies exactly on dualparameterslie themargin’sboundary,i.e., w∗,x +b = y .Recallthaty iseither+1 strictlyinsidethe n n n or 1.Therefore,theonlyu (cid:104) nknown (cid:105) isb,whichcanbecomputedby boxconstraints, − 0<αi<C.Thisis b∗ = y w∗,x . (12.42) derivedusingthe n −(cid:104) n (cid:105) KarushKuhnTucker conditions,for Remark. In principle, there may be no examples that lie exactly on the examplein margin. In this case, we should compute y w∗,x for all support Scho¨lkopfand n n | −(cid:104) (cid:105)| vectors and take the median