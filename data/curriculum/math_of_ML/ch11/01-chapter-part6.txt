We already know 1/p(x θ) from (11.16). To obtain the remaining parn | tialderivative∂p(x θ)/∂Σ ,wewritedownthedefinitionoftheGausn k | siandistributionp(x θ)(see(11.9))anddropalltermsbutthekth.We n | thenobtain ∂p(x θ) n | (11.32a) ∂Σ k = ∂Σ ∂ (cid:18) π k (2π)− D 2 det(Σ k )− 1 2 exp (cid:0) − 1 2 (x n − µ k )(cid:62)Σ− k 1(x n − µ k ) (cid:1) (cid:19) k (11.32b) = π k (2π)− D 2 (cid:20) ∂Σ ∂ det(Σ k )− 1 2 exp (cid:0) − 1 2 (x n − µ k )(cid:62)Σ− k 1(x n − µ k ) (cid:1) k +det(Σ k )− 1 2 ∂Σ ∂ exp (cid:0) − 1 2 (x n − µ k )(cid:62)Σ− k 1(x n − µ k ) (cid:1) (cid:21) . (11.32c) k Wenowusetheidentities ∂ 1 1 1 ∂Σ det(Σ k )− 2 (5. = 101) −2 det(Σ k )− 2Σ− k 1, (11.33) k ∂ (x µ )(cid:62)Σ−1(x µ ) (5. = 106) Σ−1(x µ )(x µ )(cid:62)Σ−1 ∂Σ n − k k n − k − k n − k n − k k k (11.34) andobtain(aftersomerearranging)thedesiredpartialderivativerequired in(11.31)as ∂p(x n | θ) = π (cid:0) x µ , Σ (cid:1) ∂Σ k N n | k k k (cid:2) 1(Σ−1 Σ−1(x µ )(x µ )(cid:62)Σ−1) (cid:3) . (11.35) · −2 k − k n − k n − k k Putting everything together, the partial derivative of the log-likelihood Draft(2019-12-11)of“MathematicsforMachineLearning”.Feedback:https://mml-book.com. 11.2 ParameterLearningviaMaximumLikelihood 357 withrespecttoΣ isgivenby k ∂ (cid:88) N ∂logp(x n θ) (cid:88) N 1 ∂p(x n θ) L = | = | (11.36a) ∂Σ ∂Σ p(x θ) ∂Σ k n=1 k n=1 n | k = (cid:88) N π k N (cid:0) x n | µ k , Σ k (cid:1) (cid:80)K π (cid:0) x µ , Σ (cid:1) n=1 j=1 j N n | j j (cid:124) (cid:123)(cid:122) (cid:125) =rnk (cid:2) 1(Σ−1 Σ−1(x µ )(x µ )(cid:62)Σ−1) (cid:3) (11.36b) · −2 k − k n − k n − k k N 1 (cid:88) = r (Σ−1 Σ−1(x µ )(x µ )(cid:62)Σ−1) (11.36c) −2 nk k − k n − k n − k k n=1 (cid:32) (cid:33) N N 1 (cid:88) 1 (cid:88) = Σ−1 r + Σ−1 r (x µ )(x µ )(cid:62) Σ−1. −2 k nk 2 k nk n − k n − k k n=1 n=1 (cid:124) (cid:123)(cid:122) (cid:125) =Nk (11.36d) We see that the responsibilities r also appear in this partial derivative. nk Setting this partial derivative to 0, we obtain the necessary optimality condition (cid:32) (cid:33) N (cid:88) N Σ−1 = Σ−1 r (x µ )(x µ )(cid:62) Σ−1 (11.37a) k k k nk n − k n − k k n=1 (cid:32) (cid:33) N (cid:88) N I = r (x µ )(x µ )(cid:62) Σ−1. (11.37b) ⇐⇒ k nk n − k n − k k n=1 BysolvingforΣ ,weobtain k N 1 (cid:88) Σnew = r (x µ )(x µ )(cid:62), (11.38) k N nk n − k n − k